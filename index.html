<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Text Scramble Effect</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:100" rel="stylesheet">
  <style>
    body {
      margin: 0; display: flex; justify-content: center; align-items: center;
      height: 100vh; background: #000000; color: #FFFFFF;
      font-family: 'Helvetica Neue', Arial, sans-serif;
    }
    .dud { color: #FFFFFF; }
  </style>
</head>
<body>
  <div class="text"></div>
  <script>
    const el = document.querySelector('.text'),
          chars = '!<>-_\\/[]{}â€”=+*^?#________',
          phrases = ['Welcome!', 'Welcome to NXT/WebXR!', 'NXT/WebXR'];
    let frame = 0, queue = [], counter = 0;

    function setText(newText) {
      const oldText = el.innerText, length = Math.max(oldText.length, newText.length);
      queue = [];
      for (let i = 0; i < length; i++) {
        queue.push({
          from: oldText[i] || '',
          to: newText[i] || '',
          start: Math.random() * 40 | 0, // Increased random range for slower start
          end: (Math.random() * 40 | 0) + 40, // Increased duration for slower end
          char: ''
        });
      }
      frame = 0;
      update();
    }

    function update() {
      let output = '', complete = 0;
      for (let i = 0; i < queue.length; i++) {
        let { from, to, start, end, char } = queue[i];
        if (frame >= end) {
          complete++;
          output += to;
        } else if (frame >= start) {
          if (Math.random() < 0.28) {
            char = chars[Math.random() * chars.length | 0];
            queue[i].char = char;
          }
          output += '<span class="dud">' + (char || '') + '</span>';
        } else {
          output += from;
        }
      }
      el.innerHTML = output;
      if (complete === queue.length) {
        setTimeout(next, 1600); // Increased timeout for slower transition
      } else {
        frame++;
        requestAnimationFrame(update);
      }
    }

    function next() {
      setText(phrases[counter % phrases.length]);
      counter++;
    }

    next();
  </script>
</body>
</html>
